# The wallet addresses of all affected iOS users
affected_addresses = [24975, 17851, 19692, 27697, 25064, 29144, 26897, 38179, 24470, 21931, 34508, 29861, 25829, 16832, 36981, 25264, 40955, 23530, 27403, 22844, 19296, 20085, 24923, 17720, 25594, 22375, 23796, 33972, 21580, 26069, 18509, 27714, 17485, 17877, 18753, 27837, 28551, 25842, 25740, 20329, 19520, 25121, 20105, 22918, 23528, 34360, 23120, 40753, 25957, 27245, 17702, 18081, 27264, 29258, 24984, 33536, 32030, 30606, 39357, 17788, 17671, 35532, 32328, 30748, 20737, 28439, 32838, 24413, 18846, 24748, 16792, 37246, 25621, 18496, 32055, 20505, 16760, 20909, 29145, 32154, 39532, 30605, 34587, 41601, 22902, 21865, 43161, 57639, 37750, 35028, 25084, 28094, 18863, 19851, 38899, 30941, 29226, 18430, 16605, 27301, 37437, 37494, 31332, 21231, 16869, 17088, 40602, 27418, 16719, 37548, 17103, 30356, 24768, 21341, 25926, 18630, 18817, 38307, 23365, 20052, 26908, 31585, 28339, 26260, 17356, 28847, 17582, 25372, 35487, 26679, 19920, 40351, 33272, 66341, 66432, 22914, 34210, 29300, 25393, 17923, 63635, 40909, 35165, 18902, 16665, 19548, 18145, 59448, 28209, 27626, 38818, 21114, 19118, 27431, 31892, 25589, 59570, 66757, 19492, 20123, 36774, 22637, 27935, 27702, 58831, 30443, 35591, 22036, 32131, 17664, 24966, 17622, 64977, 25491, 21687, 60406, 28239, 29180, 19536, 24914, 16560, 16549, 41734, 28879, 28634, 26399, 60555, 19727, 33403, 16846, 31172, 29622, 28714, 25305, 61208, 23414, 26210, 32182, 31664, 23831, 18158, 21622, 60803, 29679, 27067, 60906, 36860, 16934, 25774, 18681, 24302, 18352, 58308, 60596, 16844, 21332, 19654, 28683, 24151, 25670, 27560, 38789, 26166, 25566, 17767, 68156, 18975, 38841, 38481, 32545, 28900, 68382, 61179, 17675, 33427, 68217, 16687, 19226, 38450, 16612, 28692, 26779, 21193, 20725, 17592, 67040, 26681, 29261, 59419, 34144, 25562, 33437, 60148, 22197, 24225, 61420, 32760, 69405, 30201, 25716, 19339, 28978, 16956, 40295, 40296, 19494, 24560, 63450, 23314, 18281, 22583, 20271, 18428, 63499, 22934, 34144, 16493, 26545, 36501, 63717, 41815, 18945, 60846, 64137, 17121, 24220, 66298, 35669, 64454, 61238, 33951, 28914, 18310, 25922, 62426, 64588, 60335, 21700, 19251, 30316, 64653, 26279, 28449, 24694, 41272, 28629, 27934, 65352, 65407, 18893, 20132, 17783, 65095, 65180, 65037, 21189, 65039, 25431, 33039, 32585, 63572, 66064, 65120, 29885, 38519, 21627, 66101, 66109, 65662, 32856, 67047, 65964, 66248, 66202, 66253, 66120, 66332, 66266, 21273, 66346, 25305, 66116, 66138, 65442, 27431, 66144, 19228, 25095, 65306, 66608, 66163, 66115, 66027, 65388, 64610, 60538, 66193, 17242, 66261, 66478, 58050, 66490, 66384, 66485, 18143, 66320, 66246, 41815, 66177, 63470, 66291, 16687, 16695, 17366, 66364, 66415, 66428, 66380, 66467, 66419, 66541, 66515, 18075, 66399, 21193, 66772, 66756, 66282, 18075, 66765, 66815, 66808, 66806, 66802, 75484, 65827, 18863, 19296, 61652, 67008, 66975, 60042, 67062, 66823, 66824, 66845, 66862, 66618, 66865, 74542, 67253, 66879, 66904, 66906, 66901, 66898, 66850, 66915, 29180, 66870, 60596, 66920, 66951, 20505, 66907, 17884, 66957, 21048, 66931, 67095, 67032, 22017, 67110, 65007, 19881, 17260, 67057, 17783, 67085, 67048, 17995, 67060, 67069, 67088, 67058, 67175, 22341, 65980, 67167, 58445, 67176, 67020, 66182, 16612, 67401, 67463, 67500, 67473, 17093, 66628, 67438, 67471, 67385, 19978, 67518, 67538, 21578, 21264, 17006, 67006, 67205, 67221, 70341, 38636, 65352, 67250, 67125, 66979, 67232, 67252, 67299, 67286, 65113, 67016, 67300, 17366, 67336, 67333, 30613, 67351, 38789, 21846, 19654, 67367, 67421, 35084, 67510, 67553, 67607, 22723, 28391, 66118, 66549, 65793, 66535, 66658, 67010, 67428, 67671, 67637, 67583, 67678, 63388, 67670, 64044, 22918, 67633, 67493, 64412, 25372, 67735, 33205, 67714, 64447, 65312, 67737, 67752, 67753, 67711, 67814, 67730, 19583, 67749, 32158, 18325, 67793, 67567, 67767, 67775, 64579, 66068, 67813, 67785, 67788, 66504, 67685, 67933, 67454, 65008, 67891, 67190, 67886, 67865, 65597, 41912, 24968, 67223, 67760, 67949, 67952, 67966, 39330, 64048, 58963, 67991, 66769, 23826, 58963, 67578, 68144, 68153, 67245, 66304, 68065, 66974, 68185, 68184, 68176, 17671, 68224, 24220, 34321, 65095, 67802, 68282, 67346, 68214, 24293, 67003, 67695, 67683, 64719, 68255, 68267, 68279, 67501, 68444, 68365, 68340, 68394, 68036, 68023, 68068, 67727, 59072, 64840, 68081, 65163, 68076, 17951, 68017, 68404, 39586, 23303, 66527, 68389, 68264, 68386, 66342, 67774, 68190, 68334, 20159, 68345, 68426, 68464, 68425, 68465, 17788, 59098, 67447, 16705, 64646, 66671, 65195, 68513, 68500, 21204, 68538, 68511, 67076, 68483, 64330, 66231, 68568, 67610, 19920, 68614, 67348, 68583, 67556, 65081, 65081, 18533, 19040, 68482, 66142, 68627, 61208, 68687, 65708, 68655, 67696, 39357, 68738, 27231, 66668, 40291, 68708, 68066, 68764, 58924, 68775, 68134, 58163, 68719, 67419, 61179, 21373, 31585, 68606, 65234, 24688, 68630, 67555, 66740, 22583, 23869, 23869, 66694, 66732, 22353, 59444, 68820, 68878, 68920, 66374, 66236, 68863, 68848, 68864, 68835, 66782, 68868, 68912, 67203, 68974, 66742, 66712, 66719, 66760, 66748, 66642, 65286, 59199, 68239, 69033, 68965, 69092, 24607, 65039, 61144, 67368, 69124, 22167, 69044, 69120, 68067, 68810, 63294, 17808, 69135, 65629, 67154, 69133, 69220, 18533, 66816, 69201, 23153, 29185, 69515, 69502, 66832, 66688, 69431, 68922, 69552, 69544, 69472, 68546, 62426, 66591, 68995, 68953, 58601, 68985, 68611, 67910, 69014, 69027, 37217, 69160, 17361, 69082, 63707, 69365, 69392, 67943, 26489, 64861, 64576, 69089, 68999, 23860, 23860, 69444, 29185, 60137, 69404, 67116, 66450, 69475, 25594, 69493, 69509, 67432, 23173, 19536, 68604, 63617, 67159, 69701, 65934, 69594, 69714, 69640, 67626, 68243, 39158, 69728, 69650, 69746, 69765, 69668, 69758, 35532, 35199, 65311, 69530, 66162, 66588, 69596, 26627, 69068, 38601, 63717, 59161, 22361, 69600, 67220, 69583, 69581, 27837, 69619, 61880, 16934, 64454, 21700, 69397, 69334, 35028, 69710, 31674, 69718, 69690, 25974, 27471, 41891, 69844, 65037, 61050, 69794, 65033, 27545, 18817, 80140, 69391, 69897, 27231, 60555, 69907, 17361, 66083, 69099, 69850, 35119, 69704, 67165, 69935, 67951, 69963, 69950, 30973, 17356, 17767, 18800, 16600, 22499, 28339, 70067, 32131, 69774, 69964, 30232, 17579, 69412, 67343, 70091, 65034, 22971, 70108, 69832, 64755, 66226, 67803, 69822, 24248, 67375, 69755, 18693, 70176, 66821, 70137, 70211, 69540, 58220, 24882, 70065, 70181, 70245, 63917, 70239, 69114, 69943, 70123, 17638, 30185, 69739, 32084, 20724, 70307, 70278, 70302, 70265, 59570, 69853, 70326, 70334, 68908, 35883, 70350, 30316, 70355, 70208, 67913, 22432, 69756, 60994, 67204, 70370, 68350, 34587, 68129, 67616, 70432, 70431, 29679, 70227, 70250, 70256, 66796, 66928, 68474, 70206, 70298, 65075, 32856, 64588, 65219, 66790, 70427, 70438, 22517, 17850, 67875, 34511, 60620, 66827, 70450, 70464, 65903, 69588, 38899, 65558, 70503, 70485, 18128, 20791, 61496, 66044, 69225, 17685, 69248, 66353, 70526, 22499, 19251, 64137, 21687, 59954, 70551, 70707, 70578, 70594, 70696, 59339, 70604, 70713, 38448, 60335, 70542, 37583, 67552, 18164, 65528, 67640, 66568, 38519, 67164, 36009, 32091, 70947, 18902, 70740, 70949, 32158, 70995, 70998, 70829, 70913, 70909, 70746, 70817, 70823, 69276, 68548, 58308, 67222, 69294, 68660, 60279, 69349, 28521, 28692, 70832, 70868, 66141, 70844, 70914, 70711, 23303, 71040, 70939, 70968, 71000, 71047, 65691, 71014, 59392, 21580, 67766, 69342, 69360, 68223, 21311, 69284, 69273, 71077, 71062, 71135, 17695, 71110, 70640, 71115, 31664, 71145, 71156, 71191, 71189, 70609, 71252, 68847, 71198, 58505, 68213, 66032, 71220, 71317, 64985, 35133, 52756, 31424, 26506, 71270, 71221, 71183, 71232, 65116, 61067, 71280, 61079, 71355, 59789, 64996, 64923, 71258, 71129, 30106, 71454, 28683, 63842, 71259, 18255, 17654, 70793, 71365, 63422, 59246, 30106, 65042, 29144, 32534, 20768, 19672, 19548, 71688, 71697, 21234, 71681, 71664, 69240, 27626, 41234, 21834, 18025, 70859, 59246, 18406, 28759, 38019, 37602, 32464, 32497, 40296, 71742, 71301, 21620, 20568, 70980, 32028, 22585, 19559, 71604, 26838, 25032, 17760, 59071, 32581, 20045, 35969, 19431, 64513, 27650, 17703, 40239, 64662, 35139, 71659, 71730, 22349, 71628, 71410, 70730, 70830, 17579, 71455, 32581, 71424, 71820, 32051, 71596, 69522, 67291, 67200, 71208, 71441, 66183, 71981, 71992, 17566, 24198, 71065, 40349, 38602, 25312, 70899, 34880, 61725, 17999, 33839, 18683, 70477, 22036, 72077, 72271, 72294, 72316, 71451, 70292, 26489, 38580, 35119, 71916, 72107, 17486, 21162, 34994, 36130, 70777, 72125, 58851, 64693, 37311, 66836, 72132, 71074, 33816, 72176, 37652, 20668, 72512, 72489, 35961, 62527, 70851, 72518, 72521, 70806, 69074, 71800, 72514, 72533, 72532, 72542, 27830, 22215, 72551, 64288, 37700, 71379, 65083, 19235, 31889, 30356, 72585, 17647, 16480, 16480, 67153, 72564, 72587, 72331, 72350, 71171, 72354, 72371, 71521, 61002, 37523, 72406, 37151, 72402, 72395, 58384, 72143, 72261, 71624, 27403, 72617, 27545, 72660, 72647, 72662, 72548, 61319, 20123, 23633, 72676, 72779, 68598, 37842, 72812, 72838, 72234, 28929, 30693, 72336, 19386, 71247, 28492, 72307, 17760, 70586, 72831, 41098, 72882, 23490, 70965, 72864, 72680, 64486, 22324, 72654, 27021, 72774, 25716, 72742, 70435, 65457, 72899, 66481, 34449, 22585, 68155, 67361, 72771, 30784, 71087, 63499, 73121, 17121, 73115, 73114, 73041, 22564, 71443, 73052, 23831, 16554, 67871, 20014, 73083, 69990, 40151, 16609, 73119, 36012, 73148, 71024, 72314, 36012, 32653, 20724, 68984, 72684, 72186, 72934, 72942, 17088, 17851, 19480, 72951, 71217, 73170, 73162, 72501, 73159, 23120, 72941, 73196, 66206, 71388, 73158, 73205, 69740, 21865, 72565, 26722, 65482, 61636, 27532, 65323, 40462, 60580, 69263, 72949, 30737, 65482, 36466, 40349, 36466, 60631, 73260, 73266, 24245, 18280, 73091, 17323, 71236, 34210, 70611, 67139, 73281, 34508, 58851, 67244, 73290, 73314, 22270, 73312, 70570, 22215, 42798, 42798, 67497, 73346, 19069, 73133, 30606, 73356, 21073, 69549, 73386, 73357, 66216, 69471, 29807, 64849, 72191, 73482, 68357, 68337, 73495, 64979, 73522, 73523, 21848, 33816, 73590, 73576, 73399, 73426, 66665, 72103, 73465, 73639, 73638, 73455, 68329, 73456, 65048, 73625, 73673, 67301, 70491, 28629, 73048, 72456, 72598, 72943, 69507, 73694, 73714, 72651, 69367, 71434, 73466, 22361, 19854, 66064, 73511, 73763, 70506, 73790, 73884, 72560, 73757, 72745, 73276, 73800, 73813, 24814, 27935, 22854, 73832, 59375, 25095, 68489, 73855, 68643, 73887, 72634, 41730, 73857, 73906, 73863, 70769, 21861, 70885, 72075, 40115, 73983, 74318, 74343, 59197, 21861, 67312, 71134, 74076, 74089, 74092, 68607, 74099, 74024, 74050, 16945, 74049, 73924, 71692, 74088, 74153, 64061, 34156, 74100, 74113, 74131, 74032, 59364, 27227, 79806, 73975, 61614, 74204, 73318, 18352, 20105, 73948, 20132, 40271, 73979, 65422, 73966, 74274, 74291, 67134, 63566, 74216, 74219, 28714, 72544, 58930, 35458, 74239, 18893, 74259, 74276, 19588, 74284, 74280, 74255, 74258, 74238, 73001, 69381, 74074, 74477, 74363, 74524, 71937, 24413, 68874, 74544, 69541, 27697, 28205, 60758, 57639, 74362, 70653, 74364, 74281, 66463, 25665, 65112, 74419, 69032, 74656, 74630, 73313, 19786, 74541, 74263, 74557, 74573, 74682, 74494, 74568, 66578, 74609, 74615, 74605, 74741, 29423, 73497, 74775, 74770, 58051, 74588, 74672, 74578, 74704, 74722, 67043, 72726, 74791, 74507, 77178, 74801, 68692, 74806, 74834, 74866, 70029, 74871, 74601, 74890, 24882, 74903, 63615, 74915, 28708, 73373, 74396, 68770, 26779, 68161, 74669, 75023, 75004, 75025, 74979, 75058, 72404, 64732, 75071, 67627, 75135, 74997, 39713, 75203, 75220, 72174, 73652, 74636, 70133, 72591, 71654, 75228, 17923, 77308, 72766, 26687, 66288, 74960, 74984, 74882, 75302, 75303, 75330, 65649, 16844, 41601, 75308, 28449, 22998, 60344, 37683, 75091, 75112, 75126, 70788, 75047, 65428, 75352, 75045, 62541, 75365, 66073, 69623, 69145, 75131, 75157, 33577, 75429, 68094, 75449, 65382, 75472, 75465, 74527, 75185, 75373, 75355, 74879, 62527, 25666, 75396, 75358, 69047, 75412, 70547, 75448, 75177, 75437, 75173, 75538, 67850, 68010, 75525, 75557, 75555, 67810, 19023, 75699, 74197, 62805, 66553, 67362, 67673, 75764, 19088, 75563, 68954, 75082, 67411, 75632, 32877, 70563, 64530, 23032, 75570, 38147, 74417, 75818, 75754, 69321, 75547, 75902, 75906, 19088, 75541, 19534, 67924, 75958, 75961, 75947, 75841, 17995, 35929, 39523, 75899, 74919, 63616, 75584, 75615, 74369, 39962, 69153, 73145, 66039, 66366, 33536, 69889, 69823, 71238, 69043, 76072, 71137, 76125, 76108, 75513, 76151, 76142, 76153, 75451, 76174, 74540, 76193, 76209, 76190, 23820, 61880, 76346, 76356, 67488, 39024, 65717, 66062, 16845, 60237, 76795, 76266, 76261, 76471, 76259, 76270, 75572, 76230, 30494, 67676, 75903, 76550, 75916, 76573, 76564, 76570, 76580, 70606, 25974, 68609, 76603, 76640, 76487, 76503, 39962, 76620, 76666, 74565, 76481, 76618, 76877, 76037, 67323, 76609, 76641, 21834, 75318, 22564, 67979, 17840, 73566, 58803, 76777, 70460, 75127, 76805, 76798, 21206, 73786, 76527, 76856, 67381, 76490, 76830, 76701, 76784, 58865, 58831, 76973, 65278, 76587, 71435, 76890, 69371, 63581, 71206, 66542, 22937, 76957, 64467, 77004, 72530, 76650, 73271, 76925, 74000, 76299, 28010, 76885, 76944, 76938, 76927, 26838, 76682, 76559, 76592, 77064, 69154, 75701, 67028, 77084, 77123, 77088, 67170, 77097, 77117, 77085, 18998, 28521, 74906, 74776, 77367, 72738, 77001, 76659, 66987, 77018, 77060, 77191, 77221, 77203, 75952, 77251, 77262, 72415, 77109, 77179, 77132, 76790, 77173, 77155, 76859, 77297, 76638, 67896, 73683, 77330, 29227, 75239, 77241, 77390, 77379, 77609, 77637, 77488, 19640, 76466, 77426, 77278, 77446, 77476, 77435, 77435, 70706, 77264, 71890, 70410, 18003, 77746, 67042, 77742, 77640, 74087, 77683, 77505, 26275, 70579, 77356, 69828, 77757, 68044, 77738, 77815, 77807, 63552, 77610, 77885, 77862, 77569, 34825, 75735, 77918, 77922, 65395, 77911, 77953, 67173, 77935, 77794, 72785, 65662, 77813, 77848, 68318, 76252, 68819, 75590, 77642, 76179, 69337, 77856, 77879, 74520, 72260, 77980, 77972, 77998, 77994, 77997, 78034, 77342, 24904, 78032, 67635, 78081, 71136, 78178, 68967, 17103, 78103, 77984, 17006, 26720, 77720, 77853, 76737, 78006, 70273, 78142, 77648, 37456, 69716, 75859, 78216, 78107, 66312, 74887, 78129, 77910, 23519, 74563, 78187, 77851, 78183, 69079, 78279, 76208, 78294, 78293, 78302, 77522, 78112, 77759, 68052, 75248, 73284, 78236, 78277, 78251, 78296, 77599, 78213, 78190, 78151, 66645, 67013, 78406, 78282, 78366, 77687, 32585, 77698, 78461, 78480, 74650, 78497, 78400, 74242, 29034, 18653, 22164, 77632, 78550, 78492, 65307, 71078, 78692, 73411, 78710, 76213, 78651, 67513, 78608, 76644, 78580, 73017, 78634, 78730, 78743, 78524, 67097, 73207, 78823, 78830, 75898, 74412, 77872, 78902, 78899, 78877, 70201, 78878, 69655, 75000, 78452, 67369, 65306, 67717, 78918, 67101, 41173, 79140, 68950, 26995, 78790, 78819, 78803, 74106, 77120, 77913, 79060, 23820, 70094, 75844, 73862, 79238, 75265, 79151, 79126, 79130, 79125, 65213, 79269, 79291, 78286, 67946, 79153, 79157, 19587, 77919, 79422, 59262, 79262, 74370, 67193, 69675, 79317, 76175, 79373, 79376, 79386, 18706, 22448, 74466, 68304, 79565, 34065, 79576, 79542, 76377, 79545, 79612, 78259, 71429, 61727, 78052, 79570, 79652, 79707, 30784, 79716, 78891, 66446, 22998, 79824, 79836, 77833, 23826, 79849, 79478, 30941, 61238, 75245, 79631, 79608, 79619, 67320, 79644, 79243, 79645, 79743, 79740, 32246, 71075, 69618, 69131, 79812, 79831, 21968, 79618, 79919, 79925, 79933, 80106, 66855, 63429, 80129, 67022, 80022, 80043, 80065, 20339, 80148, 79402, 80021, 80031, 78774, 80383, 79897, 20159, 79314, 80278, 80294, 71988, 64992, 78664, 80353, 76385, 77433, 77167, 80126, 80109, 80134, 76989, 80151, 80157, 20407, 79377, 75297, 80426, 78484, 80287, 72576, 80554, 79876, 80218, 16996, 80629, 70139, 80636, 80645, 58520, 80251, 78721, 80701, 70005, 80815, 80746, 80774, 68038, 80797, 79751, 39562, 68132, 80736, 80818, 24572, 80802, 69546, 80796, 80854, 80937, 80940, 80963, 35575, 80911, 80894, 68628, 80162, 46319, 66425, 81030, 80983, 19978, 81028, 74310, 81085, 80733, 70556, 81113, 24966, 81153, 81160, 81227, 81265, 81189, 81167, 80920, 68104, 81340, 81040, 81361, 58995, 79345, 81565, 81701, 67908, 58638, 81529, 81397, 18280, 81712, 81715, 68308, 23546, 81818, 80875, 81640, 81820, 81810, 68344, 82055, 82037, 82063, 80245, 79572, 35597, 71344, 66433, 79603, 73806, 78885, 82104, 72383, 80470, 74833, 82248, 80460, 27471, 80677, 80680, 79666, 80711, 80699, 71452, 80714, 33601, 81260, 81269, 71446, 61691, 81263, 18945, 81043, 59038, 81314, 76953, 81390, 79231, 81449, 80747, 81511, 81493, 81326, 81545, 75783, 81528, 81288, 81426, 81365, 79569, 81564, 35239, 81718, 68159, 80254, 77600, 71108, 81846, 62002, 81889, 81811, 82028, 82011, 75167, 81960, 82004, 82128, 81220, 80273, 82379, 75300, 82417, 21622, 82491, 23693, 82480, 73274, 23693, 82359, 82513, 80851, 80099, 70194, 21547, 75599, 66506, 71658, 82670, 40151, 82665, 82791, 82892, 82884, 82121, 71864, 33601, 81634, 82526, 82924, 82984, 59472, 82989, 79384, 83066, 83036, 81445, 79815, 82149, 80539, 82222, 82686, 83195, 61873, 28028, 33203, 16665, 69213, 83178, 79351, 82636, 83284, 78250, 82284, 82326, 82336, 76562, 73144, 82339, 68541, 82279, 73407, 82481, 82426, 82420, 82411, 82455, 72540, 78266, 74912, 82509, 37523, 82542, 81952, 82570, 21547, 68703, 80281, 83300, 80311, 81761, 74862, 82732, 68694, 82817, 82850, 65107, 81544, 18967, 82907, 21578, 81195, 83017, 82981, 83018, 66531, 83090, 83089, 75928, 83227, 40137, 83473, 83498, 83464, 83528, 83606, 65325, 79599, 83781, 83750, 83761, 83779, 83778, 82081, 71408, 81732, 83947, 24572, 83819, 84122, 82465, 72438, 83222, 79697, 83335, 22054, 17904, 72844, 71049, 24607, 76616, 83173, 68580, 83402, 26154, 83420, 83503, 83527, 16845, 65308, 83441, 78136, 23546, 41272, 83307, 83564, 83635, 28404, 76906, 83764, 21968, 83712, 76440, 78192, 20737, 18616, 83888, 78534, 83984, 84005, 83927, 33150, 83727, 68154, 72959, 81357, 84087, 84145, 43225, 67398, 36501, 79398, 76831, 71516, 80205, 78010].uniq
# Set festival to boom 2023
@festival = Festival.find(60)

# Set current_user to Pete
current_user = User.find(35)

# Create a message for one address
attrs = {}
attrs[:subject] = "App Update Available!"
attrs[:body] = "Download the latest version now from the app store."
attrs[:stream] = "critical-comms"
attrs[:address_id] = Address.find(affected_addresses[0]).id
attrs[:created_by] = current_user.id
attrs[:festival_id] = @festival.id
attrs[:topic] = @festival.fcm_topic_id
@message = BomaMessagingService.new_draft(attrs)

# Send the message
BomaMessagingService.new.send_message(@message)

# Loop through each address and create a draft push notification ready to be sent
affected_addresses.uniq.each do |address_id|
  address = Address.find(address_id)
  organisation_address_from_festival_id = address.organisation_address_from_festival_id(@festival.id)
  PushNotificationsService.create_draft_push_notification_for_address(@message.subject, @message.body, address, @message, "critical-comms", organisation_address_from_festival_id, @message.id) rescue puts "Unable to create Push Notification for #{address.is}"

  puts "Created draft push notification for #{address.id} #{organisation_address_from_festival_id.registration_type} #{address.address}"
end